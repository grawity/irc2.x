From cornet@duteca3.et.tudelft.nl Mon Apr  6 10:09:08 1992
Received: from anu.anu.edu.au by coombs.anu.edu.au (5.61/1.0)
	id AA23774; Mon, 6 Apr 92 10:09:00 +1000
Received: from dutecad.et.tudelft.nl by anu.anu.edu.au (4.1/SMI-4.1)
	id AA12176; Mon, 6 Apr 92 02:09:32 EST
Received: by dutecad.et.tudelft.nl (5.57/1.34)
          id AA10685; Sun, 5 Apr 92 18:09:18 +0200
Received: by duteca3.et.tudelft.nl (AIX  2.1.2/1.34)
          id AA26615; Sun, 5 Apr 92 16:09:12 GMT
Date: Sun, 5 Apr 92 16:09:12 GMT
From: cornet@duteca3.et.tudelft.nl (Jan-Pieter Cornet)
Message-Id: <9204051609.AA26615@duteca3.et.tudelft.nl>
To: avalon@coombs.anu.edu.au
Subject: patches for 2.7.1e/HPUX
Cc: cornet@duteca3.et.tudelft.nl
Status: OR

Avalon,
 
  I needed to make the following patches to compile ircd2.7.1e for HPUX.
  The inet.h stuff is, I think, HPUX system dependend (I have not the
  slightest clue why it is needed, probably the same calls defined
  otherwise in some system include file. Didn't check it).

  The stuff for TIMES_2 in s_misc.c was definitely a coding error. I guess
  that my server is the first to use TIMES_2, then ;) (no, HPUX 7.0 doesn't
  have getrusage).

  Good luck with it,
-- Jan-Pieter
cornet@duteca.et.tudelft.nl
JohnPC@irc
 
admin of ircserver.et.tudelft.nl
----8<--------
*** inet.h
--- inet.h.jpc
**************
*** 25,30
  extern unsigned long inet_addr(const char *);
  extern char *inet_ntoa(struct in_addr);
  extern struct in_addr inet_makeaddr(int , int);
  extern unsigned long inet_network(const char *);
  extern unsigned long inet_lnaof(struct in_addr);
  extern unsigned long inet_netof(struct in_addr);
--- 25,31 -----
  extern unsigned long inet_addr(const char *);
  extern char *inet_ntoa(struct in_addr);
  extern struct in_addr inet_makeaddr(int , int);
+ #if ! HPUX
  extern unsigned long inet_network(const char *);
  extern unsigned long inet_lnaof(struct in_addr);
  extern unsigned long inet_netof(struct in_addr);
**************
*** 28,33
  extern unsigned long inet_network(const char *);
  extern unsigned long inet_lnaof(struct in_addr);
  extern unsigned long inet_netof(struct in_addr);
  #else
  extern unsigned long inet_addr();
  extern char *inet_ntoa();
--- 29,35 -----
  extern unsigned long inet_network(const char *);
  extern unsigned long inet_lnaof(struct in_addr);
  extern unsigned long inet_netof(struct in_addr);
+ #endif
  #else
  extern unsigned long inet_addr();
  extern char *inet_ntoa();
**************
*** 32,37
  extern unsigned long inet_addr();
  extern char *inet_ntoa();
  extern struct in_addr inet_makeaddr();
  extern unsigned long inet_network();
  extern unsigned long inet_lnaof();
  extern unsigned long inet_netof();
--- 34,40 -----
  extern unsigned long inet_addr();
  extern char *inet_ntoa();
  extern struct in_addr inet_makeaddr();
+ #if ! HPUX
  extern unsigned long inet_network();
  extern unsigned long inet_lnaof();
  extern unsigned long inet_netof();
**************
*** 35,38
  extern unsigned long inet_network();
  extern unsigned long inet_lnaof();
  extern unsigned long inet_netof();
  #endif
--- 38,42 -----
  extern unsigned long inet_network();
  extern unsigned long inet_lnaof();
  extern unsigned long inet_netof();
+ #endif
  #endif
*** s_misc.c
--- s_misc.c.jpc
**************
*** 502,508
  			   me.name, nick, strerror(errno));
  		return 0;
  	    }
! 	secs = tms.tms_utime + tms.tms_stime;
  
  	sendto_one(cptr,
  		   ":%s NOTICE %s :CPU Secs %d:%d User %d:%d System %d:%d",
--- 502,508 -----
  			   me.name, nick, strerror(errno));
  		return 0;
  	    }
! 	secs = tmsbuf.tms_utime + tmsbuf.tms_stime;
  
  	sendto_one(cptr,
  		   ":%s NOTICE %s :CPU Secs %d:%d User %d:%d System %d:%d",
**************
*** 507,514
  	sendto_one(cptr,
  		   ":%s NOTICE %s :CPU Secs %d:%d User %d:%d System %d:%d",
  		   me.name, nick, secs/60, secs%60,
! 		   tms.tms_utime/60, tms.tms_utime%60,
! 		   tms.tms_stime/60, tms.tms_stime%60);
  #  endif
  #endif
  	sendto_one(cptr, ":%s NOTICE %s :Reads %d Writes %d",
--- 507,514 -----
  	sendto_one(cptr,
  		   ":%s NOTICE %s :CPU Secs %d:%d User %d:%d System %d:%d",
  		   me.name, nick, secs/60, secs%60,
! 		   tmsbuf.tms_utime/60, tmsbuf.tms_utime%60,
! 		   tmsbuf.tms_stime/60, tmsbuf.tms_stime%60);
  #  endif
  #endif
  	sendto_one(cptr, ":%s NOTICE %s :Reads %d Writes %d",

